# The Snake Game
I am developing a snake game using python and pygame which will use a neural network to automatically play the game. It consists of three steps .
1. Training data generation
2. Training neural network
3. Testing

## Training data generation

Training data consists of inputs and corresponding outputs. Here, I have used the following inputs and outputs.

### Input is comprised of 7 nodes:
1. Is left blocked or is there any obstacle in left ( 1 or 0)
2. is front blocked or is there any obstacle in front (1 or 0)
3. Is right blocked or is there any obstacle in right(1 or 0)
4. Apple direction vector from snake (X)
5. Apple direction vector from snake (Y)
6. Snake’s current direction vector (X)
7. Snake’s current direction vector (Y)

### The output is comprised of 3 node
* **[1,0,0]** will move snake left
*  **[0,1,0]** will continue snake in same direction
*  **[0,0,1]** will move snake right

To generate training data, we need to keep a record of 7 inputs and 3 outputs for every step the snake takes. I have calculated the inputs for every step the snake takes.
1. To check if the direction is blocked, we look one step ahead in each direction.
2. Snake direction vector = Snake’s Head (0th index) – Snake’s 1st index
3. Apple direction from the snake = Apple’s position – Snake’s head position (See the figure below)

I have generated training data automatically. To do this I have used angle between snake and apple. On the basis of that angle, I have created a function that would tell us , in which direction snake should move.  then output is generated by first calculating the direction for the given snake and apple position, using angle between them. Now, we need to convert our directions( -1, 0 or 1 ) to output(Y), a one hot vector.

Total 1000 games will be played to train our model and input training data will be stored in **input training data(X)** and  output training data in **output training data(Y).**

## Train Neural Network

To train our neural network we need to prepare our model. We need to choose best neural network .It is difficult to find best neural network and I have used hit and trial method to find network architecture . After some hit and trials, I have found a workable architecture, which consists of 2 hidden layers one of 9 units and other of 15 units. For the hidden layer, I have used the non-linear function ‘relu’ and for the output layer, I have used ‘softmax’.

## Testing Snake Game

To test our trained snake , we need to predict the direction of snake by using input value of our model which we have fed already. Then snake will use predicted direction to move unit snake dies or games steps finish.
